<!DOCTYPE html>
<html>
<head>
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css' rel='stylesheet' />
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
      https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-database.js"></script>

  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "AIzaSyA8FKYLVLgQNADsZ7Sxcpzld2AoibMphrE",
      authDomain: "advance-nuance-239719.firebaseapp.com",
      databaseURL: "https://advance-nuance-239719.firebaseio.com",
      projectId: "advance-nuance-239719",
      storageBucket: "advance-nuance-239719.appspot.com",
      messagingSenderId: "700023040154",
      appId: "1:700023040154:web:580d64fb8235d1b4155723",
      measurementId: "G-45K5K6C2BG"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  </script>
</head>
<style>
  
  body {
    margin: 0;
    padding: 0;
  }
  
  #map {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100%;
  }

</style>
<body>
<div id='map'></div>
<script>
var db = firebase.database();
mapboxgl.accessToken = 'pk.eyJ1IjoiZXBpYzIwMyIsImEiOiJjazUzeHZ1aXkwY2FsM2xwbTk0cThsc2kwIn0.857yObOykgVvN3roDnxVVQ';
var map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/streets-v11',
center: [76.9562,10.9365], // starting position as [lng, lat]
zoom: 13
});

var popup = new mapboxgl.Popup()
    .setHTML('<h3>Potholes</h3>');
var data = {};
db.ref('/').once('value', function(snapshot) {
  snapshot.forEach(function(childSnapshot) {
    data[childSnapshot.key]=childSnapshot.val();
  });
});

//var txt=JSON.parse(data);
console.log('length:'+data.length);
console.log('perc:',data);
for (var x in data.key) {
  console.log(data[x]);
  //console.log(data[i].Position.Latitude);
}
new mapboxgl.Marker()
.setLngLat([76.9562, 10.9365])
.setPopup(popup)
.addTo(map);
db.ref

</script>
</body>
</html>